<!--<!DOCTYPE html>
<html>
<head>
    <title>Finance Dashboard</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <h1>Welcome, Finance Department</h1>
    <a href="/logout">Logout</a>
    <hr>


    <h2>Bills Overview</h2>
    {% if bills %}
        <table border="1">
            <thead>
                <tr>
                    <th>Bill ID</th>
                    <th>Patient Name</th>
                    <th>Amount</th>
                    <th>Payment Status</th>
                    <th>Payment Date</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for bill in bills %}
                <tr>
                    <td>{{ bill.id }}</td>
                    <td>{{ bill.patient_name }}</td>
                    <td>${{ bill.amount }}</td>
                    <td>{{ bill.payment_status }}</td>
                    <td>{{ bill.payment_date or 'N/A' }}</td>
                    <td>
                        {% if bill.payment_status == 'Pending' %}
                            <form action="/finance/verify_payment" method="post" style="display:inline;">
                                <input type="hidden" name="bill_id" value="{{ bill.id }}">
                                <button type="submit">Verify Payment</button>
                            </form>
                        {% else %}
                            Verified
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>No bills available.</p>
    {% endif %}

    <hr>

    <h2>Generate New Bill</h2>
    <form action="/finance/generate_bill" method="post">
        <label for="patient_id">Patient ID:</label>
        <input type="text" name="patient_id" required>

        <label for="amount">Amount ($):</label>
        <input type="number" name="amount" required>

        <button type="submit">Generate Bill</button>
    </form>

    <hr>

  
    <h2>Add New Insurance</h2>
    <form action="/finance/add_insurance" method="post">
        <label for="patient_id">Patient ID:</label>
        <input type="text" name="patient_id" required>

        <label for="provider">Provider:</label>
        <input type="text" name="provider" required>

        <label for="policy_number">Policy Number:</label>
        <input type="text" name="policy_number" required>

        <button type="submit">Add Insurance</button>
    </form>

    <hr>

    
    <h2>Submit Insurance Claim</h2>
    <form action="/finance/manage_insurance" method="post">
        <label for="patient_id">Patient ID:</label>
        <input type="text" name="patient_id" required>

        <label for="provider">Provider:</label>
        <input type="text" name="provider" required>

        <label for="policy_number">Policy Number:</label>
        <input type="text" name="policy_number" required>

        <button type="submit">Submit Insurance Claim</button>
    </form>

   
    <h2>Insurance Claims</h2>
    {% if insurance_claims %}
        <table border="1">
            <thead>
                <tr>
                    <th>Claim ID</th>
                    <th>Patient Name</th>
                    <th>Provider</th>
                    <th>Policy Number</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                {% for claim in insurance_claims %}
                <tr>
                    <td>{{ claim.id }}</td>
                    <td>{{ claim.patient_name }}</td>
                    <td>{{ claim.provider }}</td>
                    <td>{{ claim.policy_number }}</td>
                    <td>{{ claim.status }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>No insurance claims available.</p>
    {% endif %}

</body>
</html>-->
<!DOCTYPE html>
<html>
<head>
    <title>Finance Dashboard</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <script>
        function toggleInsuranceFields() {
            const checkbox = document.getElementById("claim_insurance");
            const insuranceFields = document.getElementById("insurance_fields");
            insuranceFields.style.display = checkbox.checked ? "block" : "none";
        }
    </script>
</head>
<body>
    <h1>Welcome, Finance Department</h1>
    <a href="/logout">Logout</a>
    <hr>

    <!-- Bills Overview -->
    <h2>Bills Overview</h2>
    {% if bills %}
        <table border="1">
            <thead>
                <tr>
                    <th>Bill ID</th>
                    <th>Patient Name</th>
                    <th>Original Amount</th>
                    <th>Final Amount</th>
                    <th>Payment Status</th>
                    <th>Payment Date</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for bill in bills %}
                <tr>
                    <td>{{ bill.id }}</td>
                    <td>{{ bill.patient_name }}</td>
                    <td>${{ bill.amount }}</td>
                    <td>${{ bill.final_amount or bill.amount }}</td>
                    <td>{{ bill.payment_status }}</td>
                    <td>{{ bill.payment_date or 'N/A' }}</td>
                    <td>
                        {% if bill.payment_status == 'Pending' %}
                        <form action="/finance/verify_payment" method="post" style="display:inline;">
                            <input type="hidden" name="bill_id" value="{{ bill.id }}">
                            <button type="submit">Verify</button>
                        </form>
                        {% else %}
                        Verified
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>No bills available.</p>
    {% endif %}

    <hr>

    <!-- Generate New Bill -->
    <h2>Generate New Bill</h2>
    <form action="/finance/generate_bill" method="post">
        <label for="patient_id">Patient ID:</label>
        <input type="text" name="patient_id" required><br>

        <label for="amount">Amount ($):</label>
        <input type="number" step="0.01" name="amount" required><br>

        <label><input type="checkbox" id="claim_insurance" name="claim_insurance" onchange="toggleInsuranceFields()"> Claim Insurance</label><br>

        <div id="insurance_fields" style="display:none; margin-top: 10px;">
            <label for="provider">Provider:</label>
            <input type="text" name="provider"><br>

            <label for="policy_number">Policy Number:</label>
            <input type="text" name="policy_number"><br>
        </div>

        <button type="submit">Generate Bill</button>
    </form>

    <h2>Add New Insurance</h2>
<form action="/finance/add_insurance" method="post">
    <label for="patient_id">Patient ID:</label>
    <input type="text" name="patient_id" required>

    <label for="provider">Provider:</label>
    <input type="text" name="provider" required>

    <label for="policy_number">Policy Number:</label>
    <input type="text" name="policy_number" required>

    <label for="coverage_percent">Coverage (%):</label>
    <input type="number" name="coverage_percent" min="0" max="100" required>

    <button type="submit">Add Insurance</button>
</form>

<!-- Insurance Details -->
<h2>Insurance Details</h2>
{% if insurances %}
    <table border="1">
        <thead>
            <tr>
                <th>Patient Name</th>
                <th>Provider</th>
                <th>Policy Number</th>
                <th>Coverage (%)</th>
            </tr>
        </thead>
        <tbody>
            {% for insurance in insurances %}
            <tr>
                <td>{{ insurance.patient_name }}</td>
                <td>{{ insurance.provider }}</td>
                <td>{{ insurance.policy_number }}</td>
                <td>{{ insurance.coverage_percent }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% else %}
    <p>No insurance data available.</p>
{% endif %}


</body>
</html>
